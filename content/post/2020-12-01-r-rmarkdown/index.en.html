---
title: "The R Markdown document for VAERS analysis"
author: "Dr. Jessica Rose"
date: "2021-05-21"
output: html_document
---

<script src="{{< blogdown/postref >}}index.en_files/header-attrs/header-attrs.js"></script>
<script src="{{< blogdown/postref >}}index.en_files/htmlwidgets/htmlwidgets.js"></script>
<script src="{{< blogdown/postref >}}index.en_files/plotly-binding/plotly.js"></script>
<script src="{{< blogdown/postref >}}index.en_files/typedarray/typedarray.min.js"></script>
<script src="{{< blogdown/postref >}}index.en_files/jquery/jquery.min.js"></script>
<link href="{{< blogdown/postref >}}index.en_files/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="{{< blogdown/postref >}}index.en_files/crosstalk/js/crosstalk.min.js"></script>
<link href="{{< blogdown/postref >}}index.en_files/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="{{< blogdown/postref >}}index.en_files/plotly-main/plotly-latest.min.js"></script>


<p>This is an R Markdown sheet generated from the VAERS data. I included some code but for the most part, only figures are shown. I decided to show figures pertaining to Death, Spontaneous abortions, Breakthrough COVID-19 infections and Cardiovascular, Neurological and Immunological adverse events.</p>
<p>I start by coalescing the .csv files downloaded from the VAERS website: <a href="https://vaers.hhs.gov/data/datasets.html" class="uri">https://vaers.hhs.gov/data/datasets.html</a></p>
<pre class="r"><code>library(&quot;readr&quot;)
library(&quot;tidyverse&quot;)</code></pre>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.5     ✓ dplyr   1.0.7
## ✓ tibble  3.1.1     ✓ stringr 1.4.0
## ✓ tidyr   1.1.3     ✓ forcats 0.5.1
## ✓ purrr   0.3.4</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(&quot;dplyr&quot;)
library(&quot;ggplot2&quot;)
library(&quot;stringr&quot;)
library(&quot;DT&quot;)
library(&quot;reshape2&quot;)</code></pre>
<pre><code>## 
## Attaching package: &#39;reshape2&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     smiths</code></pre>
<pre class="r"><code>library(&quot;data.table&quot;)</code></pre>
<pre><code>## 
## Attaching package: &#39;data.table&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:reshape2&#39;:
## 
##     dcast, melt</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     between, first, last</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     transpose</code></pre>
<pre class="r"><code>library(&quot;plotly&quot;)</code></pre>
<pre><code>## 
## Attaching package: &#39;plotly&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     last_plot</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre><code>## The following object is masked from &#39;package:graphics&#39;:
## 
##     layout</code></pre>
<pre class="r"><code>library(&quot;lubridate&quot;)</code></pre>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:data.table&#39;:
## 
##     hour, isoweek, mday, minute, month, quarter, second, wday, week,
##     yday, year</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     date, intersect, setdiff, union</code></pre>
<p>SET KNIT CONDITIONS FOR CHUNKS IN MARKDOWN FILE</p>
<p>THIS IS THE MERGE FILE THAT HAS NO FILTERING OF VARIABLES</p>
<pre><code>## [1] 388900</code></pre>
<pre><code>## [1] 5163</code></pre>
<pre><code>## [1] 22612</code></pre>
<pre><code>## [1] 52399</code></pre>
<pre><code>## [1] 66769</code></pre>
<pre><code>## [1] 17.16868</code></pre>
<p>BAR PLOT FOR SAE COMPARISON TO STANDARD</p>
<pre><code>##   Percent_SAE   SAE PERC
## 1    Standard 58000   15
## 2      Actual 66769   17</code></pre>
<p><img src="Figs/unnamed-chunk-7-1.png" width="672" />
BREAKTHROUGH COVID19 CASES</p>
<pre><code>## [1] 9442</code></pre>
<p>SOME CHARTS FOR BREAKTHROUGH COVID CASES (BCC)
<img src="Figs/unnamed-chunk-10-1.png" width="672" />
PIE CHART FOR BREAKTHROUGH COVID CASES</p>
<pre><code>## [1] 5351</code></pre>
<p>****** FROM HERE DOWN IS ALL AGE-GROUPED STUFF ******
NOW YOU CAN ADD COLUMNS FOR AGE GROUPS
FIRST CREATE AGE GROUPS FUNCTION</p>
<p>NOW DO AGE GROUP FOR PIE CHART FOR BREAKTHROUGH CASES</p>
<p>PIE CHART</p>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"visdat":{"f4e73242a41d":["function () ","plotlyVisDat"]},"cur_data":"f4e73242a41d","attrs":{"f4e73242a41d":{"labels":{},"values":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"pie"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"BREAKTHROUGH COVID-19 CASES RESULTING IN DEATH BY AGE GROUP","xaxis":{"showgrid":false,"zeroline":false,"showticklabels":false},"yaxis":{"showgrid":false,"zeroline":false,"showticklabels":false},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"labels":["D. 30-40","E. 40-50","F. 50-60","G. 60-70","H.70-80","I. 80-90","J. 90-100","K. 100-110"],"values":[0.07,0.12,0.36,0.97,1.51,2,0.88,0.1],"type":"pie","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(255,255,255,1)"}},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>MAKE HISTOGRAMS FOR Female Reproductive Issues (FRI)
<img src="Figs/unnamed-chunk-19-1.png" width="672" /></p>
<pre><code>##   diff_in_days    n OBSERVED Percentage_OBSERVED EXPECTED Percentage_EXPECTED
## 1       1 days 1243     1243           17.566422      138            1.822263
## 2       0 days 1038     1038           14.669305      138            1.822263
## 3       2 days  678      678            9.581685      138            1.822263
## 4       3 days  457      457            6.458451      138            1.822263
## 5       4 days  295      295            4.169022      138            1.822263
## 6       7 days  288      288            4.070096      138            1.822263</code></pre>
<pre><code>## 
##  Chi-squared test for given probabilities
## 
## data:  FRI_CASES_VD_OD$OBSERVED
## X-squared = 20370, df = 50, p-value &lt; 2.2e-16</code></pre>
<p>FRI HEATMAP
<img src="Figs/unnamed-chunk-21-1.png" width="672" /></p>
<pre><code>## # A tibble: 1,777 x 4
## # Groups:   VAX_DATE, ONSET_DATE [1,777]
##    VAX_DATE   ONSET_DATE diff_in_days     n
##    &lt;date&gt;     &lt;date&gt;     &lt;drtn&gt;       &lt;int&gt;
##  1 2021-04-01 2021-04-01 0 days          53
##  2 2021-04-08 2021-04-08 0 days          32
##  3 2021-04-08 2021-04-09 1 days          32
##  4 2021-04-09 2021-04-10 1 days          30
##  5 2021-04-15 2021-04-16 1 days          29
##  6 2021-04-01 2021-04-02 1 days          28
##  7 2021-04-06 2021-04-07 1 days          27
##  8 2021-04-06 2021-04-06 0 days          26
##  9 2021-04-07 2021-04-08 1 days          26
## 10 2021-04-07 2021-04-07 0 days          24
## # … with 1,767 more rows</code></pre>
<p>**** Symmetric: Values between -0.5 to 0.5
Moderated Skewed data: Values between -1 and -0.5 or between 0.5 and 1
Highly Skewed data: Values less than -1 or greater than 1 *****
<img src="Figs/unnamed-chunk-22-1.png" width="672" /></p>
<pre><code>##     AGE_GROUP    n       skew
## 1     A. 0-10    2 -0.2971185
## 2    B. 10-20   73 -0.2971185
## 3    C. 20-30  713 -0.2971185
## 4    D. 30-40  940 -0.2971185
## 5    E. 40-50 1096 -0.2971185
## 6    F. 50-60 1200 -0.2971185
## 7    G. 60-70 1268 -0.2971185
## 8     H.70-80 1068 -0.2971185
## 9    I. 80-90  675 -0.2971185
## 10  J. 90-100  250 -0.2971185
## 11 K. 100-110   18 -0.2971185</code></pre>
<p>MAKING A TABLE OF THE DATA FOR COVID-19
<img src="Figs/unnamed-chunk-23-1.png" width="672" />
<img src="Figs/unnamed-chunk-24-1.png" width="672" />
LET’S count how many days we have between vax and death and hospital and ER…</p>
<p>NOW I WOULD LIKE TO PLOT Percentage_OBSERVED AGAINST Percentage_EXPECTED
<img src="Figs/unnamed-chunk-26-1.png" width="672" />
HOW ABOUT HEATMAPS?
<img src="Figs/unnamed-chunk-27-1.png" width="672" /></p>
<p>NOW I WOULD LIKE TO PLOT Percentage_OBSERVED AGAINST Percentage_EXPECTED
<img src="Figs/unnamed-chunk-29-1.png" width="672" />
HOW ABOUT HEATMAPS?
<img src="Figs/unnamed-chunk-30-1.png" width="672" /></p>
<p>NOW I WOULD LIKE TO PLOT Percentage_OBSERVED AGAINST Percentage_EXPECTED
<img src="Figs/unnamed-chunk-32-1.png" width="672" />
HOW ABOUT HEATMAPS?
<img src="Figs/unnamed-chunk-33-1.png" width="672" />
NOW YOU CAN IMPLEMENT OUR AGE_GROUPED_BY_DECADE FUNCTION FOR THE SEPARATE MANUFACTURER DATA FRAMES</p>
<p>HISTOGRAM PLOTS TO SHOW DISTRIBUTION OF AGE IN THE DEATH, hospital and er groups
<img src="Figs/unnamed-chunk-35-1.png" width="672" /></p>
<pre><code>##     AGE_GROUP    n     skew
## 1     A. 0-10   21 1.550019
## 2    B. 10-20   19 1.550019
## 3    C. 20-30   51 1.550019
## 4    D. 30-40  102 1.550019
## 5    E. 40-50  181 1.550019
## 6    F. 50-60  380 1.550019
## 7    G. 60-70  858 1.550019
## 8     H.70-80 1151 1.550019
## 9    I. 80-90 1166 1.550019
## 10  J. 90-100  603 1.550019
## 11 K. 100-110   46 1.550019</code></pre>
<p><img src="Figs/unnamed-chunk-35-2.png" width="672" /></p>
<pre><code>##     AGE_GROUP    n      skew
## 1     A. 0-10   68 0.1709395
## 2    B. 10-20  937 0.1709395
## 3    C. 20-30 1232 0.1709395
## 4    D. 30-40 1820 0.1709395
## 5    E. 40-50 2186 0.1709395
## 6    F. 50-60 2989 0.1709395
## 7    G. 60-70 4114 0.1709395
## 8     H.70-80 4244 0.1709395
## 9    I. 80-90 2612 0.1709395
## 10  J. 90-100  726 0.1709395
## 11 K. 100-110   18 0.1709395</code></pre>
<p><img src="Figs/unnamed-chunk-35-3.png" width="672" /></p>
<pre><code>##     AGE_GROUP    n       skew
## 1     A. 0-10   78 -0.5719112
## 2    B. 10-20 2360 -0.5719112
## 3    C. 20-30 5974 -0.5719112
## 4    D. 30-40 8865 -0.5719112
## 5    E. 40-50 8990 -0.5719112
## 6    F. 50-60 8585 -0.5719112
## 7    G. 60-70 7486 -0.5719112
## 8     H.70-80 5316 -0.5719112
## 9    I. 80-90 2527 -0.5719112
## 10  J. 90-100  714 -0.5719112
## 11 K. 100-110   24 -0.5719112</code></pre>
<p>DISTRIBUTION OF ALL DATA BY AGE GROUP
<img src="Figs/unnamed-chunk-36-1.png" width="672" /></p>
<pre><code>##     AGE_YRS    n     skew
## 1      0.00    1 1.524048
## 2      0.08   20 1.524048
## 3      0.17   39 1.524048
## 4      0.25   11 1.524048
## 5      0.33   26 1.524048
## 6      0.42    7 1.524048
## 7      0.50   19 1.524048
## 8      0.58   14 1.524048
## 9      0.67    5 1.524048
## 10     0.75   11 1.524048
## 11     0.83    3 1.524048
## 12     0.92    6 1.524048
## 13     1.00   47 1.524048
## 14     1.08   28 1.524048
## 15     1.17    3 1.524048
## 16     1.25   15 1.524048
## 17     1.33    5 1.524048
## 18     1.42    3 1.524048
## 19     1.50   10 1.524048
## 20     1.58    2 1.524048
## 21     1.75    1 1.524048
## 22     1.83    3 1.524048
## 23     1.92    3 1.524048
## 24     2.00   17 1.524048
## 25     2.17    1 1.524048
## 26     2.50    1 1.524048
## 27     3.00   18 1.524048
## 28     4.00   40 1.524048
## 29     4.17    1 1.524048
## 30     4.33    1 1.524048
## 31     4.42    1 1.524048
## 32     4.58    1 1.524048
## 33     5.00   16 1.524048
## 34     5.25    1 1.524048
## 35     5.33    1 1.524048
## 36     5.50    1 1.524048
## 37     5.92    3 1.524048
## 38     6.00   11 1.524048
## 39     7.00   18 1.524048
## 40     8.00   14 1.524048
## 41     9.00   10 1.524048
## 42    10.00   33 1.524048
## 43    11.00  289 1.524048
## 44    12.00  826 1.524048
## 45    13.00 1012 1.524048
## 46    14.00 1215 1.524048
## 47    15.00 1755 1.524048
## 48    16.00 3189 1.524048
## 49    17.00 4343 1.524048
## 50    18.00 2488 1.524048
## 51    19.00 2696 1.524048
## 52    20.00 2873 1.524048
## 53    21.00 3175 1.524048
## 54    22.00 3508 1.524048
## 55    23.00 3787 1.524048
## 56    24.00 4116 1.524048
## 57    25.00 4387 1.524048
## 58    26.00 4696 1.524048
## 59    27.00 4882 1.524048
## 60    28.00 5144 1.524048
## 61    29.00 5402 1.524048
## 62    30.00 5803 1.524048
## 63    31.00 6000 1.524048
## 64    32.00 6191 1.524048
## 65    33.00 6246 1.524048
## 66    34.00 6424 1.524048
## 67    35.00 6468 1.524048
## 68    36.00 6512 1.524048
## 69    37.00 6756 1.524048
## 70    38.00 6783 1.524048
## 71    39.00 6757 1.524048
## 72    40.00 6723 1.524048
## 73    41.00 6739 1.524048
## 74    42.00 6428 1.524048
## 75    43.00 6473 1.524048
## 76    44.00 6127 1.524048
## 77    45.00 6285 1.524048
## 78    46.00 6278 1.524048
## 79    47.00 6003 1.524048
## 80    48.00 6289 1.524048
## 81    49.00 6607 1.524048
## 82    50.00 7195 1.524048
## 83    51.00 6660 1.524048
## 84    52.00 6387 1.524048
## 85    53.00 6205 1.524048
## 86    54.00 6171 1.524048
## 87    55.00 6229 1.524048
## 88    56.00 6550 1.524048
## 89    57.00 6499 1.524048
## 90    58.00 6599 1.524048
## 91    59.00 6530 1.524048
## 92    60.00 6642 1.524048
## 93    61.00 6340 1.524048
## 94    62.00 6090 1.524048
## 95    63.00 6118 1.524048
## 96    64.00 5860 1.524048
## 97    65.00 6751 1.524048
## 98    66.00 6276 1.524048
## 99    67.00 5979 1.524048
## 100   68.00 5787 1.524048
## 101   69.00 5337 1.524048
## 102   70.00 5228 1.524048
## 103   71.00 4984 1.524048
## 104   72.00 4575 1.524048
## 105   73.00 4485 1.524048
## 106   74.00 4159 1.524048
## 107   75.00 3312 1.524048
## 108   76.00 3043 1.524048
## 109   77.00 2933 1.524048
## 110   78.00 2822 1.524048
## 111   79.00 2314 1.524048
## 112   80.00 2022 1.524048
## 113   81.00 1713 1.524048
## 114   82.00 1684 1.524048
## 115   83.00 1508 1.524048
## 116   84.00 1295 1.524048
## 117   85.00 1141 1.524048
## 118   86.00 1069 1.524048
## 119   87.00  945 1.524048
## 120   88.00  813 1.524048
## 121   89.00  738 1.524048
## 122   90.00  672 1.524048
## 123   91.00  540 1.524048
## 124   92.00  461 1.524048
## 125   93.00  396 1.524048
## 126   94.00  330 1.524048
## 127   95.00  257 1.524048
## 128   96.00  190 1.524048
## 129   97.00  149 1.524048
## 130   98.00   91 1.524048
## 131   99.00   61 1.524048
## 132  100.00   55 1.524048
## 133  101.00   35 1.524048
## 134  102.00   17 1.524048
## 135  103.00   16 1.524048
## 136  104.00    4 1.524048
## 137  105.00    6 1.524048
## 138  106.00    2 1.524048
## 139  113.00    1 1.524048
## 140  115.00    5 1.524048
## 141  119.00    2 1.524048</code></pre>
<pre><code>## # A tibble: 2 x 2
## # Groups:   VAX_DOSE_SERIES [2]
##   VAX_DOSE_SERIES      n
##   &lt;chr&gt;            &lt;int&gt;
## 1 1               206282
## 2 2               113020</code></pre>
<pre><code>## # A tibble: 2 x 4
## # Groups:   VAX_DOSE_SERIES [2]
##   VAX_DOSE_SERIES      n    SUM PERCENT
##   &lt;chr&gt;            &lt;int&gt;  &lt;int&gt;   &lt;dbl&gt;
## 1 1               206282 319302    64.6
## 2 2               113020 319302    35.4</code></pre>
<p>MAKING A TABLE OF THE DATA HERE INSTEAD OF IN EXCEL</p>
<p>STATISTIC SAE/MILLION FV</p>
<p>THIS IS THE PERCENTAGE INCREASE CALCULATION OF ID PER WEEK</p>
<p>THIS IS THE PERCENTAGE TABLE FOR ID AND FV FOR PLOTS</p>
<p>THIS IS THE TABLE FOR IDs NORMALIZED TO TOTAL IDs</p>
<p>THIS IS THE IDs NORMALIZED TO US POPULATION</p>
<p>This is the table of the VAERS ID counts from 1990 to 2021.</p>
<p><img src="Figs/unnamed-chunk-46-1.png" width="672" />
<img src="Figs/unnamed-chunk-47-1.png" width="672" />
ABSOLUTE NUMBERS OF AEs
<img src="Figs/unnamed-chunk-48-1.png" width="672" />
IDS NORMALIZED TO FV PER MILLION
<img src="Figs/unnamed-chunk-49-1.png" width="672" /></p>
<pre><code>## [1] 14828</code></pre>
<p><img src="Figs/unnamed-chunk-50-1.png" width="672" />
FRI HEATMAP
<img src="Figs/unnamed-chunk-51-1.png" width="672" />
```</p>
